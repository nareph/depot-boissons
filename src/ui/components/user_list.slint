// src/ui/components/user_list.slint (Corrig√©)

import { ListView } from "std-widgets.slint";
import { ModernButton } from "./button.slint";
import { UserUI } from "./models.slint";

export component UserList inherits VerticalLayout {
    in property <[UserUI]> users;
    callback add-user;
    callback delete-user(string);

    padding: 25px;
    spacing: 15px;

    HorizontalLayout {
        alignment: center;
        Text { text: "Gestion des Utilisateurs"; font-size: 24px; font-weight: 700; color: #ececec; }
        Rectangle { width: 100%; }
        ModernButton {
            text: "Ajouter";
            icon: "‚ûï";
            height: 40px;
            min-width: 150px;
            clicked => { root.add-user() }
        }
    }
    
    VerticalLayout {
        // En-t√™te du tableau
        HorizontalLayout {
            // CORRECTION: padding explicite
            padding-left: 15px;
            padding-right: 15px;

            Text { text: "Nom"; font-weight: 700; width: 250px; color: #aaa; }
            Text { text: "Email"; font-weight: 700; width: 350px; color: #aaa; }
            Text { text: "R√¥le"; font-weight: 700; width: 120px; color: #aaa; }
            Text { text: "Actions"; font-weight: 700; color: #aaa; }
        }
        // CORRECTION: margin explicite
        Rectangle { height: 2px; background: #333; }

        ListView {
            for user in root.users: HorizontalLayout {
                alignment: center;
                padding-top: 10px;
                padding-bottom: 10px;
                padding-left: 15px;
                padding-right: 15px;
                
                Text { text: user.name; width: 250px; color: #ddd; overflow: elide; }
                Text { text: user.email; width: 350px; color: #ddd; overflow: elide; }
                
                // Badge de r√¥le
                HorizontalLayout {
                    width: 120px;
                    Rectangle {
                        height: 25px;
                        background: user.role == "Admin" ? rgba(102, 126, 234, 0.3) : rgba(46, 213, 115, 0.3);
                        border-radius: 12px;
                        
                        HorizontalLayout {
                            padding-left: 10px;
                            padding-right: 10px;
                            alignment: center;
                            Text {
                                text: user.role;
                                font-size: 12px;
                                font-weight: 600;
                                color: user.role == "Admin" ? #667eea : #2ed573;
                            }
                        }
                    }
                }
                
                Rectangle { width: 100%; }

                ModernButton {
                    text: "Supprimer";
                    icon: "üóëÔ∏è";
                    height: 35px;
                    min-width: 130px;
                    kind: "danger";
                    clicked => { root.delete-user(user.id) }
                }
            }
        }
    }
}